<form [formGroup]="form" (ngSubmit)="save()">
  <div>
    <label>Title</label>
    <input formControlName="title" />
    @if (form.controls.title.invalid && form.controls.title.touched) {
      <small>Title is required.</small>
    }
  </div>

  <div>
    <label>Description</label>
    <textarea rows="3" formControlName="description"></textarea>
  </div>

  <fieldset formGroupName="startDate">
    <legend>Start Date</legend>
    <label>Year</label>
    <input type="number" formControlName="year" />
    <label>Month</label>
    <input type="number" min="0" max="11" formControlName="month" />
    <label>Week</label>
    <input type="number" min="0" max="3" formControlName="week" />
  </fieldset>

  <fieldset formGroupName="endDate">
    <legend>End Date</legend>
    <label>Year</label>
    <input type="number" formControlName="year" />
    <label>Month</label>
    <input type="number" min="0" max="11" formControlName="month" />
    <label>Week</label>
    <input type="number" min="0" max="3" formControlName="week" />
  </fieldset>

  <section>
    <h3>Additional Fields</h3>
    <div [formGroup]="additionalFieldForm">
      <input placeholder="Key" formControlName="key" />
      <input placeholder="Value" formControlName="value" />
      <button type="button" (click)="addAdditionalField()">Add field</button>
    </div>
    @if (additionalFieldForm.controls.key.errors?.['duplicated']) {
      <small>The field already exists.</small>
    }
    <div>
      @for (field of additionalFieldList(); track field.key) {
        <div>
          <label>{{ field.key }}</label>
          <input [formControl]="field.control" />
          <button type="button" (click)="removeAdditionalField(field.key)">Eliminar</button>
        </div>
      }
    </div>
  </section>

  <div>
    <button type="submit">Save changes</button>
  </div>
</form>
